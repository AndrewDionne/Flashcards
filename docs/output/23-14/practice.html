<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>{set_name} Practice</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        body {{
            font-family: sans-serif;
            background-color: #f0f0f0;
            padding: 20px;
            text-align: center;
        }}
        .flash {{
            margin: 10px;
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }}
        .result {{
            font-size: 1.2em;
            margin-top: 20px;
        }}
    </style>
</head>
<body>
    <h1>{set_name} Practice Mode</h1>
    <button class="flash" onclick="window.location.href='flashcards.html'">⬅️ Back to Flashcards</button>
    <div id="result" class="result"></div>

    <script>
        const cards = {cards_json};
        let index = 0;

        function speak(text, lang, cb) {{
            const u = new SpeechSynthesisUtterance(text);
            u.lang = lang;
            u.onend = cb;
            speechSynthesis.speak(u);
        }}

        function playAudio(file, cb) {{
            const audio = new Audio(file);
            audio.onended = cb;
            audio.play();
        }}

        function runPractice() {{
            const entry = cards[index];
            const audioFile = `../../static/{set_name}/audio/${{index}}_${{entry.phrase.replace(/[^a-zA-Z0-9]/g, "_")}}.mp3`;

            speak(entry.meaning, "en-US", () => {{
                playAudio(audioFile, () => {{
                    document.getElementById("result").textContent = `${{entry.meaning}}: ${{entry.phrase}} (${{entry.pronunciation}})`;
                    index++;
                    if (index < cards.length) {{
                        setTimeout(runPractice, 2000);
                    }} else {{
                        document.getElementById("result").textContent = "✅ Practice complete!";
                    }}
                }});
            }});
        }}

        document.addEventListener("DOMContentLoaded", runPractice);
    </script>
</body>
</html>
