<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>{set_name} Practice</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        body {{
            font-family: sans-serif;
            background-color: #f0f0f0;
            padding: 20px;
            text-align: center;
        }}
        .flash {{
            margin: 10px;
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }}
        .result {{
            font-size: 1.2em;
            margin-top: 20px;
        }}
    </style>
</head>
<body>
    <h1>{set_name} Practice Mode</h1>
    <button class="flash" onclick="window.location.href='flashcards.html'">‚¨ÖÔ∏è Back to Flashcards</button>
    <div id="result" class="result">üéô Get ready to practice...</div>

    <script>
        const cards = {cards_json};
        let index = 0;

        function sanitize(text) {{
            return text.replace(/[^a-zA-Z0-9]/g, '_');
        }}

        function speak(text, lang, cb) {{
            const u = new SpeechSynthesisUtterance(text);
            u.lang = lang;
            u.onend = cb;
            speechSynthesis.speak(u);
        }}

        function playAudio(file, cb) {{
            const audio = new Audio(file);
            audio.onended = cb;
            audio.play();
        }}

        function runPractice() {{
            const entry = cards[index];
            const file = `../../static/{set_name}/audio/${index}_${sanitize(entry.phrase)}.mp3`;
            speak(entry.meaning, "en-US", () => {
                playAudio(file, () => {
                    speak(entry.phrase, "pl-PL", () => {
                        document.getElementById("result").textContent = `${entry.meaning}: ${entry.phrase} (${entry.pronunciation})`;
                        index++;
                        if (index < cards.length) {
                            setTimeout(runPractice, 3000);
                        } else {
                            document.getElementById("result").textContent = "‚úÖ Practice complete!";
                        }
                    });
                });
            });
        }}

        document.addEventListener("DOMContentLoaded", runPractice);
    </script>
</body>
</html>
